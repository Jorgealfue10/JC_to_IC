      subroutine fit3d(r12,r13,r23,e,der)
      implicit real * 8 (a-h,o-z)
      dimension der(3)
      call diat12(r12,e12,d12)
      call diat12(r13,e13,d13)
      call diat23(r23,e23,d23)
      call triabb(r12,r13,r23,e123,der)
      e=e12+e13+e23+e123
      der(1)=d12+der(1)
      der(2)=d13+der(2)
      der(3)=d23+der(3)
      return
      end
************************************************************************
      subroutine diat12(r,ener,der)
************************************************************************
*     This subroutine computes the energies of a diatomic potential 
*     fitted to    98 points
*     rms =      0.09931002 kcal/mol
*     emax =      0.52791206 kcal/mol
************************************************************************
      implicit real*8 (a-h,o-z)
      dimension cf( 12)
      data cf(  1)/-.1971533737636653D+06/
      data cf(  2)/-.1948782421552826D+01/
      data cf(  3)/0.1608952198524174D+03/
      data cf(  4)/0.5422701880179836D+05/
      data cf(  5)/-.2855438179545632D+06/
      data cf(  6)/0.1001600531122707D+08/
      data cf(  7)/-.1292220264975650D+09/
      data cf(  8)/0.1253841703245569D+10/
      data cf(  9)/-.7969799289291076D+10/
      data cf( 10)/0.3286311411115605D+11/
      data cf( 11)/-.7847903610644846D+11/
      data cf( 12)/0.8501896396090298D+11/
      e0= 0.0000000D+00
      der=0.d0
      vex1=0.1234365226755229D+01
      vex2=0.2623250354135468D+01
      aux = 1.d0/r
      bux = dexp(-vex2*r)*aux
      cux = dexp(-vex1*r)
      ener=e0+cf(1)*bux
      dux=1.d0
      eux=r*cux
      do 1 i=2, 12
         der=der+(i-1)*cf(i)*dux
         dux=dux*eux
         ener=ener+cf(i)*dux
    1 continue
      der=der*(1.d0-vex1*r)*cux
      der=der-cf(1)*(vex2+aux)*bux
      return
      end
************************************************************************
      subroutine diat23(r,ener,der)
************************************************************************
*     This subroutine computes the energies of a diatomic potential 
*     fitted to    54 points
*     rms =      0.01313906 kcal/mol
*     emax =      0.02569214 kcal/mol
************************************************************************
      implicit real*8 (a-h,o-z)
      dimension cf( 10)
      data cf(  1)/0.9868161669545947D+00/
      data cf(  2)/-.4616913914932754D+01/
      data cf(  3)/0.8394708966198503D+02/
      data cf(  4)/-.1626687102331120D+04/
      data cf(  5)/0.2318321414946718D+05/
      data cf(  6)/-.2244745726564176D+06/
      data cf(  7)/0.1420816956409127D+07/
      data cf(  8)/-.5599669962476606D+07/
      data cf(  9)/0.1243435446466672D+08/
      data cf( 10)/-.1186445396974585D+08/
      e0= 0.0000000D+00
      der=0.d0
      vex1=0.1738667008846850D+01
      vex2=0.1838953157530075D+01
      aux = 1.d0/r
      bux = dexp(-vex2*r)*aux
      cux = dexp(-vex1*r)
      ener=e0+cf(1)*bux
      dux=1.d0
      eux=r*cux
      do 1 i=2, 10
         der=der+(i-1)*cf(i)*dux
         dux=dux*eux
         ener=ener+cf(i)*dux
    1 continue
      der=der*(1.d0-vex1*r)*cux
      der=der-cf(1)*(vex2+aux)*bux
      return
      end
*************************************************************
      subroutine triabb(r12,r13,r23,ener,der)       
*************************************************************
*     This subroutine computes the energies of a 3D PES     
*     for the ABB system class fitted to 3000 points      
*     rms =      0.26291686 kcal/mol                              
*     emax =      3.51980164 kcal/mol                             
*************************************************************
      implicit real*8(a-h,o-z)                               
      dimension i1(  140),i2(  140),i3(  140),i4(  140),cf(  140)  
      dimension f12(0: 9),f13(0: 9),f23(0: 9)
      dimension der(3)
      data cf(  1)/0.3408807178620223D+06/
      data i1(  1)/ 1/,i2(  1)/ 1/,i3(  1)/ 0/,i4(  1)/ 2/
      data cf(  2)/-.3753027113969011D+06/
      data i1(  2)/ 1/,i2(  2)/ 0/,i3(  2)/ 1/,i4(  2)/ 1/
      data cf(  3)/0.1390671495017531D+07/
      data i1(  3)/ 1/,i2(  3)/ 1/,i3(  3)/ 1/,i4(  3)/ 1/
      data cf(  4)/-.3738697656967639D+06/
      data i1(  4)/ 2/,i2(  4)/ 1/,i3(  4)/ 0/,i4(  4)/ 2/
      data cf(  5)/0.1007258221803419D+07/
      data i1(  5)/ 2/,i2(  5)/ 0/,i3(  5)/ 1/,i4(  5)/ 2/
      data cf(  6)/-.3974572786833753D+07/
      data i1(  6)/ 0/,i2(  6)/ 2/,i3(  6)/ 1/,i4(  6)/ 2/
      data cf(  7)/-.7670429399288261D+07/
      data i1(  7)/ 2/,i2(  7)/ 1/,i3(  7)/ 1/,i4(  7)/ 2/
      data cf(  8)/0.1608664940170698D+08/
      data i1(  8)/ 1/,i2(  8)/ 2/,i3(  8)/ 1/,i4(  8)/ 1/
      data cf(  9)/0.8712871591017892D+06/
      data i1(  9)/ 2/,i2(  9)/ 2/,i3(  9)/ 0/,i4(  9)/ 2/
      data cf( 10)/-.1506330568228774D+07/
      data i1( 10)/ 2/,i2( 10)/ 0/,i3( 10)/ 2/,i4( 10)/ 1/
      data cf( 11)/0.9841450222085237D+06/
      data i1( 11)/ 3/,i2( 11)/ 1/,i3( 11)/ 0/,i4( 11)/ 2/
      data cf( 12)/-.1394849210508425D+07/
      data i1( 12)/ 3/,i2( 12)/ 0/,i3( 12)/ 1/,i4( 12)/ 2/
      data cf( 13)/0.1998277190150069D+08/
      data i1( 13)/ 0/,i2( 13)/ 3/,i3( 13)/ 1/,i4( 13)/ 2/
      data cf( 14)/0.1236712056791471D+08/
      data i1( 14)/ 2/,i2( 14)/ 2/,i3( 14)/ 1/,i4( 14)/ 2/
      data cf( 15)/0.1150241145242903D+08/
      data i1( 15)/ 2/,i2( 15)/ 1/,i3( 15)/ 2/,i4( 15)/ 1/
      data cf( 16)/0.1258908576383403D+08/
      data i1( 16)/ 3/,i2( 16)/ 1/,i3( 16)/ 1/,i4( 16)/ 2/
      data cf( 17)/-.1375179635067274D+09/
      data i1( 17)/ 1/,i2( 17)/ 3/,i3( 17)/ 1/,i4( 17)/ 1/
      data cf( 18)/-.5889470664818388D+07/
      data i1( 18)/ 3/,i2( 18)/ 2/,i3( 18)/ 0/,i4( 18)/ 2/
      data cf( 19)/0.1341011257424218D+07/
      data i1( 19)/ 3/,i2( 19)/ 0/,i3( 19)/ 2/,i4( 19)/ 2/
      data cf( 20)/0.1430721695606299D+08/
      data i1( 20)/ 0/,i2( 20)/ 3/,i3( 20)/ 2/,i4( 20)/ 2/
      data cf( 21)/-.1231099608903438D+07/
      data i1( 21)/ 4/,i2( 21)/ 1/,i3( 21)/ 0/,i4( 21)/ 2/
      data cf( 22)/0.8572875574490644D+06/
      data i1( 22)/ 4/,i2( 22)/ 0/,i3( 22)/ 1/,i4( 22)/ 2/
      data cf( 23)/-.5875832912000369D+08/
      data i1( 23)/ 0/,i2( 23)/ 4/,i3( 23)/ 1/,i4( 23)/ 2/
      data cf( 24)/-.2308176986637953D+08/
      data i1( 24)/ 2/,i2( 24)/ 2/,i3( 24)/ 2/,i4( 24)/ 1/
      data cf( 25)/-.4502214516177361D+08/
      data i1( 25)/ 3/,i2( 25)/ 2/,i3( 25)/ 1/,i4( 25)/ 2/
      data cf( 26)/-.1104629863224020D+08/
      data i1( 26)/ 3/,i2( 26)/ 1/,i3( 26)/ 2/,i4( 26)/ 2/
      data cf( 27)/0.5149919318575235D+08/
      data i1( 27)/ 1/,i2( 27)/ 3/,i3( 27)/ 2/,i4( 27)/ 2/
      data cf( 28)/-.8556398454881671D+06/
      data i1( 28)/ 3/,i2( 28)/ 3/,i3( 28)/ 0/,i4( 28)/ 2/
      data cf( 29)/-.4874734781742859D+06/
      data i1( 29)/ 3/,i2( 29)/ 0/,i3( 29)/ 3/,i4( 29)/ 1/
      data cf( 30)/-.7224740209747108D+07/
      data i1( 30)/ 4/,i2( 30)/ 1/,i3( 30)/ 1/,i4( 30)/ 2/
      data cf( 31)/0.4414499713049101D+09/
      data i1( 31)/ 1/,i2( 31)/ 4/,i3( 31)/ 1/,i4( 31)/ 1/
      data cf( 32)/0.1169340840198517D+08/
      data i1( 32)/ 4/,i2( 32)/ 2/,i3( 32)/ 0/,i4( 32)/ 2/
      data cf( 33)/-.7344395719796134D+06/
      data i1( 33)/ 4/,i2( 33)/ 0/,i3( 33)/ 2/,i4( 33)/ 2/
      data cf( 34)/-.8542649672198597D+08/
      data i1( 34)/ 0/,i2( 34)/ 4/,i3( 34)/ 2/,i4( 34)/ 2/
      data cf( 35)/0.4065069807292115D+05/
      data i1( 35)/ 5/,i2( 35)/ 1/,i3( 35)/ 0/,i4( 35)/ 2/
      data cf( 36)/-.5728728087269279D+05/
      data i1( 36)/ 5/,i2( 36)/ 0/,i3( 36)/ 1/,i4( 36)/ 2/
      data cf( 37)/0.1181495593599874D+09/
      data i1( 37)/ 0/,i2( 37)/ 5/,i3( 37)/ 1/,i4( 37)/ 2/
      data cf( 38)/0.3158653690011212D+08/
      data i1( 38)/ 3/,i2( 38)/ 2/,i3( 38)/ 2/,i4( 38)/ 2/
      data cf( 39)/-.2527521629183547D+08/
      data i1( 39)/ 2/,i2( 39)/ 3/,i3( 39)/ 2/,i4( 39)/ 1/
      data cf( 40)/0.7805659020952247D+08/
      data i1( 40)/ 3/,i2( 40)/ 3/,i3( 40)/ 1/,i4( 40)/ 2/
      data cf( 41)/0.1737209212384504D+07/
      data i1( 41)/ 3/,i2( 41)/ 1/,i3( 41)/ 3/,i4( 41)/ 1/
      data cf( 42)/0.2564088186084895D+08/
      data i1( 42)/ 4/,i2( 42)/ 2/,i3( 42)/ 1/,i4( 42)/ 2/
      data cf( 43)/0.7373374274638238D+07/
      data i1( 43)/ 4/,i2( 43)/ 1/,i3( 43)/ 2/,i4( 43)/ 2/
      data cf( 44)/-.2443293783285531D+09/
      data i1( 44)/ 1/,i2( 44)/ 4/,i3( 44)/ 2/,i4( 44)/ 2/
      data cf( 45)/-.3973828333834323D+08/
      data i1( 45)/ 4/,i2( 45)/ 3/,i3( 45)/ 0/,i4( 45)/ 2/
      data cf( 46)/0.3263576942314903D+06/
      data i1( 46)/ 4/,i2( 46)/ 0/,i3( 46)/ 3/,i4( 46)/ 2/
      data cf( 47)/0.7924434167688802D+08/
      data i1( 47)/ 0/,i2( 47)/ 4/,i3( 47)/ 3/,i4( 47)/ 2/
      data cf( 48)/-.3729460723479900D+06/
      data i1( 48)/ 5/,i2( 48)/ 1/,i3( 48)/ 1/,i4( 48)/ 2/
      data cf( 49)/-.7124902616613132D+09/
      data i1( 49)/ 1/,i2( 49)/ 5/,i3( 49)/ 1/,i4( 49)/ 1/
      data cf( 50)/-.2350206502107699D+07/
      data i1( 50)/ 5/,i2( 50)/ 2/,i3( 50)/ 0/,i4( 50)/ 2/
      data cf( 51)/-.1922835191016108D+06/
      data i1( 51)/ 5/,i2( 51)/ 0/,i3( 51)/ 2/,i4( 51)/ 2/
      data cf( 52)/0.1836527234185140D+09/
      data i1( 52)/ 0/,i2( 52)/ 5/,i3( 52)/ 2/,i4( 52)/ 2/
      data cf( 53)/0.4545954608574345D+06/
      data i1( 53)/ 6/,i2( 53)/ 1/,i3( 53)/ 0/,i4( 53)/ 2/
      data cf( 54)/0.2878252773538434D+05/
      data i1( 54)/ 6/,i2( 54)/ 0/,i3( 54)/ 1/,i4( 54)/ 2/
      data cf( 55)/-.1771723836051443D+09/
      data i1( 55)/ 0/,i2( 55)/ 6/,i3( 55)/ 1/,i4( 55)/ 2/
      data cf( 56)/-.3217751949348787D+08/
      data i1( 56)/ 3/,i2( 56)/ 3/,i3( 56)/ 2/,i4( 56)/ 2/
      data cf( 57)/0.8616739958838839D+07/
      data i1( 57)/ 3/,i2( 57)/ 2/,i3( 57)/ 3/,i4( 57)/ 1/
      data cf( 58)/-.3127452439779138D+08/
      data i1( 58)/ 4/,i2( 58)/ 2/,i3( 58)/ 2/,i4( 58)/ 2/
      data cf( 59)/0.1445301103029434D+09/
      data i1( 59)/ 2/,i2( 59)/ 4/,i3( 59)/ 2/,i4( 59)/ 1/
      data cf( 60)/-.4973388530108391D+08/
      data i1( 60)/ 4/,i2( 60)/ 3/,i3( 60)/ 1/,i4( 60)/ 2/
      data cf( 61)/-.2721994305506052D+07/
      data i1( 61)/ 4/,i2( 61)/ 1/,i3( 61)/ 3/,i4( 61)/ 2/
      data cf( 62)/-.5854647939871075D+08/
      data i1( 62)/ 1/,i2( 62)/ 4/,i3( 62)/ 3/,i4( 62)/ 2/
      data cf( 63)/0.5397955913938417D+08/
      data i1( 63)/ 4/,i2( 63)/ 4/,i3( 63)/ 0/,i4( 63)/ 2/
      data cf( 64)/0.6551572503661402D+07/
      data i1( 64)/ 4/,i2( 64)/ 0/,i3( 64)/ 4/,i4( 64)/ 1/
      data cf( 65)/0.5882304049778279D+07/
      data i1( 65)/ 5/,i2( 65)/ 2/,i3( 65)/ 1/,i4( 65)/ 2/
      data cf( 66)/0.2509296260488299D+07/
      data i1( 66)/ 5/,i2( 66)/ 1/,i3( 66)/ 2/,i4( 66)/ 2/
      data cf( 67)/0.4046400407805472D+09/
      data i1( 67)/ 1/,i2( 67)/ 5/,i3( 67)/ 2/,i4( 67)/ 2/
      data cf( 68)/0.1397035072216448D+08/
      data i1( 68)/ 5/,i2( 68)/ 3/,i3( 68)/ 0/,i4( 68)/ 2/
      data cf( 69)/-.5216547280039464D+07/
      data i1( 69)/ 5/,i2( 69)/ 0/,i3( 69)/ 3/,i4( 69)/ 2/
      data cf( 70)/-.2165592301180807D+09/
      data i1( 70)/ 0/,i2( 70)/ 5/,i3( 70)/ 3/,i4( 70)/ 2/
      data cf( 71)/-.1285107981108736D+07/
      data i1( 71)/ 6/,i2( 71)/ 1/,i3( 71)/ 1/,i4( 71)/ 2/
      data cf( 72)/0.5599167202536835D+09/
      data i1( 72)/ 1/,i2( 72)/ 6/,i3( 72)/ 1/,i4( 72)/ 1/
      data cf( 73)/-.3354922092224705D+07/
      data i1( 73)/ 6/,i2( 73)/ 2/,i3( 73)/ 0/,i4( 73)/ 2/
      data cf( 74)/0.2465144454957541D+07/
      data i1( 74)/ 6/,i2( 74)/ 0/,i3( 74)/ 2/,i4( 74)/ 2/
      data cf( 75)/-.1567316329157671D+09/
      data i1( 75)/ 0/,i2( 75)/ 6/,i3( 75)/ 2/,i4( 75)/ 2/
      data cf( 76)/0.3654596518431713D+06/
      data i1( 76)/ 7/,i2( 76)/ 1/,i3( 76)/ 0/,i4( 76)/ 2/
      data cf( 77)/-.5263337044469552D+06/
      data i1( 77)/ 7/,i2( 77)/ 0/,i3( 77)/ 1/,i4( 77)/ 2/
      data cf( 78)/0.1927200040784059D+09/
      data i1( 78)/ 0/,i2( 78)/ 7/,i3( 78)/ 1/,i4( 78)/ 2/
      data cf( 79)/-.3669501936078499D+08/
      data i1( 79)/ 3/,i2( 79)/ 3/,i3( 79)/ 3/,i4( 79)/ 1/
      data cf( 80)/0.5564706968028632D+08/
      data i1( 80)/ 4/,i2( 80)/ 3/,i3( 80)/ 2/,i4( 80)/ 2/
      data cf( 81)/0.5365540519116048D+07/
      data i1( 81)/ 4/,i2( 81)/ 2/,i3( 81)/ 3/,i4( 81)/ 2/
      data cf( 82)/-.1591082374462348D+07/
      data i1( 82)/ 2/,i2( 82)/ 4/,i3( 82)/ 3/,i4( 82)/ 2/
      data cf( 83)/0.5063143156981037D+08/
      data i1( 83)/ 4/,i2( 83)/ 4/,i3( 83)/ 1/,i4( 83)/ 2/
      data cf( 84)/-.1678415818237303D+08/
      data i1( 84)/ 4/,i2( 84)/ 1/,i3( 84)/ 4/,i4( 84)/ 1/
      data cf( 85)/-.3717300219912146D+07/
      data i1( 85)/ 5/,i2( 85)/ 2/,i3( 85)/ 2/,i4( 85)/ 2/
      data cf( 86)/-.1700123124618155D+09/
      data i1( 86)/ 2/,i2( 86)/ 5/,i3( 86)/ 2/,i4( 86)/ 1/
      data cf( 87)/-.1308494432779954D+08/
      data i1( 87)/ 5/,i2( 87)/ 3/,i3( 87)/ 1/,i4( 87)/ 2/
      data cf( 88)/0.1392250195712465D+08/
      data i1( 88)/ 5/,i2( 88)/ 1/,i3( 88)/ 3/,i4( 88)/ 2/
      data cf( 89)/0.4017862579229947D+06/
      data i1( 89)/ 1/,i2( 89)/ 5/,i3( 89)/ 3/,i4( 89)/ 2/
      data cf( 90)/-.2755093615608541D+08/
      data i1( 90)/ 5/,i2( 90)/ 4/,i3( 90)/ 0/,i4( 90)/ 2/
      data cf( 91)/-.1185581556976945D+07/
      data i1( 91)/ 5/,i2( 91)/ 0/,i3( 91)/ 4/,i4( 91)/ 2/
      data cf( 92)/-.1518306138872154D+08/
      data i1( 92)/ 0/,i2( 92)/ 5/,i3( 92)/ 4/,i4( 92)/ 2/
      data cf( 93)/0.1333092393618351D+07/
      data i1( 93)/ 6/,i2( 93)/ 2/,i3( 93)/ 1/,i4( 93)/ 2/
      data cf( 94)/-.7654489172468791D+07/
      data i1( 94)/ 6/,i2( 94)/ 1/,i3( 94)/ 2/,i4( 94)/ 2/
      data cf( 95)/-.3023010243397069D+09/
      data i1( 95)/ 1/,i2( 95)/ 6/,i3( 95)/ 2/,i4( 95)/ 2/
      data cf( 96)/0.6301868123838029D+07/
      data i1( 96)/ 6/,i2( 96)/ 3/,i3( 96)/ 0/,i4( 96)/ 2/
      data cf( 97)/0.2288953280745482D+07/
      data i1( 97)/ 6/,i2( 97)/ 0/,i3( 97)/ 3/,i4( 97)/ 2/
      data cf( 98)/0.2243390045016873D+09/
      data i1( 98)/ 0/,i2( 98)/ 6/,i3( 98)/ 3/,i4( 98)/ 2/
      data cf( 99)/0.2454507592115695D+07/
      data i1( 99)/ 7/,i2( 99)/ 1/,i3( 99)/ 1/,i4( 99)/ 2/
      data cf(100)/-.1424402082075829D+09/
      data i1(100)/ 1/,i2(100)/ 7/,i3(100)/ 1/,i4(100)/ 1/
      data cf(101)/-.2468004548645978D+06/
      data i1(101)/ 7/,i2(101)/ 2/,i3(101)/ 0/,i4(101)/ 2/
      data cf(102)/-.1451444980694889D+07/
      data i1(102)/ 7/,i2(102)/ 0/,i3(102)/ 2/,i4(102)/ 2/
      data cf(103)/0.1298898565826718D+08/
      data i1(103)/ 0/,i2(103)/ 7/,i3(103)/ 2/,i4(103)/ 2/
      data cf(104)/-.3544862697902268D+06/
      data i1(104)/ 8/,i2(104)/ 1/,i3(104)/ 0/,i4(104)/ 2/
      data cf(105)/0.3522090009076235D+06/
      data i1(105)/ 8/,i2(105)/ 0/,i3(105)/ 1/,i4(105)/ 2/
      data cf(106)/-.1302078504214639D+09/
      data i1(106)/ 0/,i2(106)/ 8/,i3(106)/ 1/,i4(106)/ 2/
      data cf(107)/-.1995290974974986D+07/
      data i1(107)/ 4/,i2(107)/ 3/,i3(107)/ 3/,i4(107)/ 2/
      data cf(108)/0.3112934958785458D+08/
      data i1(108)/ 3/,i2(108)/ 4/,i3(108)/ 3/,i4(108)/ 1/
      data cf(109)/-.3252026282565074D+08/
      data i1(109)/ 4/,i2(109)/ 4/,i3(109)/ 2/,i4(109)/ 2/
      data cf(110)/0.6933021256619612D+07/
      data i1(110)/ 4/,i2(110)/ 2/,i3(110)/ 4/,i4(110)/ 1/
      data cf(111)/-.1391826795216312D+07/
      data i1(111)/ 5/,i2(111)/ 3/,i3(111)/ 2/,i4(111)/ 2/
      data cf(112)/-.6698080699332782D+07/
      data i1(112)/ 5/,i2(112)/ 2/,i3(112)/ 3/,i4(112)/ 2/
      data cf(113)/0.1304209936886987D+08/
      data i1(113)/ 2/,i2(113)/ 5/,i3(113)/ 3/,i4(113)/ 2/
      data cf(114)/0.6608717123867688D+07/
      data i1(114)/ 5/,i2(114)/ 4/,i3(114)/ 1/,i4(114)/ 2/
      data cf(115)/0.1965094541474138D+07/
      data i1(115)/ 5/,i2(115)/ 1/,i3(115)/ 4/,i4(115)/ 2/
      data cf(116)/-.1936485997467824D+08/
      data i1(116)/ 1/,i2(116)/ 5/,i3(116)/ 4/,i4(116)/ 2/
      data cf(117)/0.1734225424796895D+08/
      data i1(117)/ 5/,i2(117)/ 5/,i3(117)/ 0/,i4(117)/ 2/
      data cf(118)/0.6971704804841235D+05/
      data i1(118)/ 5/,i2(118)/ 0/,i3(118)/ 5/,i4(118)/ 1/
      data cf(119)/0.5078046207403149D+07/
      data i1(119)/ 6/,i2(119)/ 2/,i3(119)/ 2/,i4(119)/ 2/
      data cf(120)/0.6200626634552534D+08/
      data i1(120)/ 2/,i2(120)/ 6/,i3(120)/ 2/,i4(120)/ 1/
      data cf(121)/0.1904431007689151D+07/
      data i1(121)/ 6/,i2(121)/ 3/,i3(121)/ 1/,i4(121)/ 2/
      data cf(122)/-.3797254204777463D+07/
      data i1(122)/ 6/,i2(122)/ 1/,i3(122)/ 3/,i4(122)/ 2/
      data cf(123)/0.1558217413418376D+08/
      data i1(123)/ 1/,i2(123)/ 6/,i3(123)/ 3/,i4(123)/ 2/
      data cf(124)/-.2920785922483159D+07/
      data i1(124)/ 6/,i2(124)/ 4/,i3(124)/ 0/,i4(124)/ 2/
      data cf(125)/0.7658754873026539D+05/
      data i1(125)/ 6/,i2(125)/ 0/,i3(125)/ 4/,i4(125)/ 2/
      data cf(126)/-.1527357759476914D+08/
      data i1(126)/ 0/,i2(126)/ 6/,i3(126)/ 4/,i4(126)/ 2/
      data cf(127)/-.2304095998966111D+07/
      data i1(127)/ 7/,i2(127)/ 2/,i3(127)/ 1/,i4(127)/ 2/
      data cf(128)/0.2500201867809676D+07/
      data i1(128)/ 7/,i2(128)/ 1/,i3(128)/ 2/,i4(128)/ 2/
      data cf(129)/0.8289156351937655D+08/
      data i1(129)/ 1/,i2(129)/ 7/,i3(129)/ 2/,i4(129)/ 2/
      data cf(130)/-.7528557013496066D+06/
      data i1(130)/ 7/,i2(130)/ 3/,i3(130)/ 0/,i4(130)/ 2/
      data cf(131)/-.2646601138283010D+06/
      data i1(131)/ 7/,i2(131)/ 0/,i3(131)/ 3/,i4(131)/ 2/
      data cf(132)/-.7720767171445612D+08/
      data i1(132)/ 0/,i2(132)/ 7/,i3(132)/ 3/,i4(132)/ 2/
      data cf(133)/-.7324594986642168D+06/
      data i1(133)/ 8/,i2(133)/ 1/,i3(133)/ 1/,i4(133)/ 2/
      data cf(134)/-.2892688829082877D+08/
      data i1(134)/ 1/,i2(134)/ 8/,i3(134)/ 1/,i4(134)/ 1/
      data cf(135)/0.5035255752213110D+06/
      data i1(135)/ 8/,i2(135)/ 2/,i3(135)/ 0/,i4(135)/ 2/
      data cf(136)/0.2088202248243598D+06/
      data i1(136)/ 8/,i2(136)/ 0/,i3(136)/ 2/,i4(136)/ 2/
      data cf(137)/0.3276692672094566D+08/
      data i1(137)/ 0/,i2(137)/ 8/,i3(137)/ 2/,i4(137)/ 2/
      data cf(138)/0.5970353922928592D+05/
      data i1(138)/ 9/,i2(138)/ 1/,i3(138)/ 0/,i4(138)/ 2/
      data cf(139)/-.5610417372293292D+05/
      data i1(139)/ 9/,i2(139)/ 0/,i3(139)/ 1/,i4(139)/ 2/
      data cf(140)/0.3938250779985205D+08/
      data i1(140)/ 0/,i2(140)/ 9/,i3(140)/ 1/,i4(140)/ 2/
      vex1=0.4771082273186982D+00
      vex2=0.8384961090522866D+00
      f12(0)=1.d0
      f13(0)=1.d0
      f23(0)=1.d0
      bux12=r12*dexp(-vex1*r12)
      bux13=r13*dexp(-vex1*r13)
      bux23=r23*dexp(-vex2*r23)
      do 1 i=1, 9
         f12(i)=f12(i-1)*bux12
         f13(i)=f13(i-1)*bux13
         f23(i)=f23(i-1)*bux23
1     continue
      ener = 0.d0
      der12 = 0.d0
      der13 = 0.d0
      der23 = 0.d0
      do 2 l=1,140
         if (i4(l).eq.1) then                             
            aux=f12(i1(l))*f13(i3(l))*f23(i2(l))          
            dux12=i1(l)*f12(i1(l)-1)*f13(i3(l))*f23(i2(l))
            dux13=i3(l)*f12(i1(l))*f13(i3(l)-1)*f23(i2(l))
            dux23=i2(l)*f12(i1(l))*f13(i3(l))*f23(i2(l)-1)
         else                                             
            aux1=f12(i1(l))*f13(i3(l))                    
            aux2=f12(i3(l))*f13(i1(l))                    
            aux=(aux1+aux2)*f23(i2(l))                    
            dux23=(aux1+aux2)*i2(l)*f23(i2(l)-1)          
            dux1=i1(l)*f12(i1(l)-1)*f13(i3(l))            
            dux2=i3(l)*f12(i3(l)-1)*f13(i1(l))            
            dux12=(dux1+dux2)*f23(i2(l))                  
            dux1=i3(l)*f12(i1(l))*f13(i3(l)-1)            
            dux2=i1(l)*f12(i3(l))*f13(i1(l)-1)            
            dux13=(dux1+dux2)*f23(i2(l))                  
         endif                                            
         ener=ener+cf(l)*aux                              
         der12=der12+cf(l)*dux12                          
         der13=der13+cf(l)*dux13                          
         der23=der23+cf(l)*dux23                          
    2 continue                                          
      der(1)=der12*(1.d0-vex1*r12)*dexp(-vex1*r12)        
      der(2)=der13*(1.d0-vex1*r13)*dexp(-vex1*r13)        
      der(3)=der23*(1.d0-vex2*r23)*dexp(-vex2*r23)        
      return
      end
