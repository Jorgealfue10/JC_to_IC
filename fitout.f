      subroutine fit3d(r12,r13,r23,e,der)
      implicit real * 8 (a-h,o-z)
      dimension der(3)
      call diat12(r12,e12,d12)
      call diat12(r13,e13,d13)
      call diat23(r23,e23,d23)
      call triabb(r12,r13,r23,e123,der)
      e=e12+e13+e23+e123
      der(1)=d12+der(1)
      der(2)=d13+der(2)
      der(3)=d23+der(3)
      return
      end
************************************************************************
      subroutine diat12(r,ener,der)
************************************************************************
*     This subroutine computes the energies of a diatomic potential 
*     fitted to   103 points
*     rms =      0.72123742 kcal/mol
*     emax =      3.11857030 kcal/mol
************************************************************************
      implicit real*8 (a-h,o-z)
      dimension cf( 12)
      data cf(  1)/-.1914158672571172D+02/
      data cf(  2)/0.1268459493997708D+03/
      data cf(  3)/-.9108950814150236D+04/
      data cf(  4)/0.1214308577963649D+07/
      data cf(  5)/-.1027449034420245D+09/
      data cf(  6)/0.5627669173970952D+10/
      data cf(  7)/-.2018846810739218D+12/
      data cf(  8)/0.4767814118675400D+13/
      data cf(  9)/-.7322030601978327D+14/
      data cf( 10)/0.7019813875278107D+15/
      data cf( 11)/-.3809098810774196D+16/
      data cf( 12)/0.8919778735952254D+16/
      !e0= 0.0000000D+00
      e0=-341.094160970000
      der=0.d0
      vex1=0.2500290431097651D+01
      vex2=0.1005341239965219D+01
      aux = 1.d0/r
      bux =  dexp(-vex2*r)*aux
      cux = dexp(-vex1*r)
      ener=e0+cf(1)*bux
      dux=1.d0
      eux=r*cux
      do 1 i=2, 12
         der=der+(i-1)*cf(i)*dux
         dux=dux*eux
         ener=ener+cf(i)*dux
    1 continue
      der=der*(1.d0-vex1*r)*cux
      der=der-cf(1)*(vex2+aux)*bux
      return
      end
************************************************************************
      subroutine diat23(r,ener,der)
************************************************************************
*     This subroutine computes the energies of a diatomic potential 
*     fitted to    54 points
*     rms =      0.01313906 kcal/mol
*     emax =      0.02569214 kcal/mol
************************************************************************
      implicit real*8 (a-h,o-z)
      dimension cf( 10)
      data cf(  1)/0.9868161669545947D+00/
      data cf(  2)/-.4616913914932754D+01/
      data cf(  3)/0.8394708966198503D+02/
      data cf(  4)/-.1626687102331120D+04/
      data cf(  5)/0.2318321414946718D+05/
      data cf(  6)/-.2244745726564176D+06/
      data cf(  7)/0.1420816956409127D+07/
      data cf(  8)/-.5599669962476606D+07/
      data cf(  9)/0.1243435446466672D+08/
      data cf( 10)/-.1186445396974585D+08/
      e0=-0.9999979701
      der=0.d0
      vex1=0.1738667008846850D+01
      vex2=0.1838953157530075D+01
      aux = 1.d0/r
      bux = dexp(-vex2*r)*aux
      cux = dexp(-vex1*r)
      ener=e0+cf(1)*bux
      dux=1.d0
      eux=r*cux
      do 1 i=2, 10
         der=der+(i-1)*cf(i)*dux
         dux=dux*eux
         ener=ener+cf(i)*dux
    1 continue
      der=der*(1.d0-vex1*r)*cux
      der=der-cf(1)*(vex2+aux)*bux
      return
      end
*************************************************************
      subroutine triabb(r12,r13,r23,ener,der)       
*************************************************************
*     This subroutine computes the energies of a 3D PES     
*     for the ABB system class fitted to 3000 points      
*     rms =      0.26739584 kcal/mol                              
*     emax =      3.43698591 kcal/mol                             
*************************************************************
      implicit real*8(a-h,o-z)                               
      dimension i1(  140),i2(  140),i3(  140),i4(  140),cf(  140)  
      dimension f12(0: 9),f13(0: 9),f23(0: 9)
      dimension der(3)
      data cf(  1)/0.2503132009408749D+06/
      data i1(  1)/ 1/,i2(  1)/ 1/,i3(  1)/ 0/,i4(  1)/ 2/
      data cf(  2)/-.2630144778103118D+06/
      data i1(  2)/ 1/,i2(  2)/ 0/,i3(  2)/ 1/,i4(  2)/ 1/
      data cf(  3)/0.8665894362497877D+06/
      data i1(  3)/ 1/,i2(  3)/ 1/,i3(  3)/ 1/,i4(  3)/ 1/
      data cf(  4)/-.2852884184869235D+06/
      data i1(  4)/ 2/,i2(  4)/ 1/,i3(  4)/ 0/,i4(  4)/ 2/
      data cf(  5)/0.7225816143139580D+06/
      data i1(  5)/ 2/,i2(  5)/ 0/,i3(  5)/ 1/,i4(  5)/ 2/
      data cf(  6)/-.2947120442204759D+07/
      data i1(  6)/ 0/,i2(  6)/ 2/,i3(  6)/ 1/,i4(  6)/ 2/
      data cf(  7)/-.5595280195428284D+07/
      data i1(  7)/ 2/,i2(  7)/ 1/,i3(  7)/ 1/,i4(  7)/ 2/
      data cf(  8)/0.1358551394395809D+08/
      data i1(  8)/ 1/,i2(  8)/ 2/,i3(  8)/ 1/,i4(  8)/ 1/
      data cf(  9)/0.4839415291673497D+06/
      data i1(  9)/ 2/,i2(  9)/ 2/,i3(  9)/ 0/,i4(  9)/ 2/
      data cf( 10)/-.8440471407789168D+06/
      data i1( 10)/ 2/,i2( 10)/ 0/,i3( 10)/ 2/,i4( 10)/ 1/
      data cf( 11)/0.9018771931813956D+06/
      data i1( 11)/ 3/,i2( 11)/ 1/,i3( 11)/ 0/,i4( 11)/ 2/
      data cf( 12)/-.1150221623853087D+07/
      data i1( 12)/ 3/,i2( 12)/ 0/,i3( 12)/ 1/,i4( 12)/ 2/
      data cf( 13)/0.1490932953162248D+08/
      data i1( 13)/ 0/,i2( 13)/ 3/,i3( 13)/ 1/,i4( 13)/ 2/
      data cf( 14)/0.8626872188377693D+07/
      data i1( 14)/ 2/,i2( 14)/ 2/,i3( 14)/ 1/,i4( 14)/ 2/
      data cf( 15)/0.6729530818644830D+07/
      data i1( 15)/ 2/,i2( 15)/ 1/,i3( 15)/ 2/,i4( 15)/ 1/
      data cf( 16)/0.1039052141362253D+08/
      data i1( 16)/ 3/,i2( 16)/ 1/,i3( 16)/ 1/,i4( 16)/ 2/
      data cf( 17)/-.1131607686001454D+09/
      data i1( 17)/ 1/,i2( 17)/ 3/,i3( 17)/ 1/,i4( 17)/ 1/
      data cf( 18)/-.5563363896021537D+07/
      data i1( 18)/ 3/,i2( 18)/ 2/,i3( 18)/ 0/,i4( 18)/ 2/
      data cf( 19)/0.7528624790139301D+06/
      data i1( 19)/ 3/,i2( 19)/ 0/,i3( 19)/ 2/,i4( 19)/ 2/
      data cf( 20)/0.1317076292517171D+08/
      data i1( 20)/ 0/,i2( 20)/ 3/,i3( 20)/ 2/,i4( 20)/ 2/
      data cf( 21)/-.1215357747298905D+07/
      data i1( 21)/ 4/,i2( 21)/ 1/,i3( 21)/ 0/,i4( 21)/ 2/
      data cf( 22)/0.8790452434557069D+06/
      data i1( 22)/ 4/,i2( 22)/ 0/,i3( 22)/ 1/,i4( 22)/ 2/
      data cf( 23)/-.4387868489766238D+08/
      data i1( 23)/ 0/,i2( 23)/ 4/,i3( 23)/ 1/,i4( 23)/ 2/
      data cf( 24)/-.1273266479039090D+08/
      data i1( 24)/ 2/,i2( 24)/ 2/,i3( 24)/ 2/,i4( 24)/ 1/
      data cf( 25)/-.3702722576205375D+08/
      data i1( 25)/ 3/,i2( 25)/ 2/,i3( 25)/ 1/,i4( 25)/ 2/
      data cf( 26)/-.6766716821312929D+07/
      data i1( 26)/ 3/,i2( 26)/ 1/,i3( 26)/ 2/,i4( 26)/ 2/
      data cf( 27)/0.4360124040988314D+08/
      data i1( 27)/ 1/,i2( 27)/ 3/,i3( 27)/ 2/,i4( 27)/ 2/
      data cf( 28)/0.1242598607028957D+07/
      data i1( 28)/ 3/,i2( 28)/ 3/,i3( 28)/ 0/,i4( 28)/ 2/
      data cf( 29)/0.1818783526582111D+06/
      data i1( 29)/ 3/,i2( 29)/ 0/,i3( 29)/ 3/,i4( 29)/ 1/
      data cf( 30)/-.7062907158135150D+07/
      data i1( 30)/ 4/,i2( 30)/ 1/,i3( 30)/ 1/,i4( 30)/ 2/
      data cf( 31)/0.3688977065827402D+09/
      data i1( 31)/ 1/,i2( 31)/ 4/,i3( 31)/ 1/,i4( 31)/ 1/
      data cf( 32)/0.1108202723132125D+08/
      data i1( 32)/ 4/,i2( 32)/ 2/,i3( 32)/ 0/,i4( 32)/ 2/
      data cf( 33)/-.7011513676725624D+06/
      data i1( 33)/ 4/,i2( 33)/ 0/,i3( 33)/ 2/,i4( 33)/ 2/
      data cf( 34)/-.7659901850408952D+08/
      data i1( 34)/ 0/,i2( 34)/ 4/,i3( 34)/ 2/,i4( 34)/ 2/
      data cf( 35)/0.1549634244495427D+06/
      data i1( 35)/ 5/,i2( 35)/ 1/,i3( 35)/ 0/,i4( 35)/ 2/
      data cf( 36)/-.1579593238516596D+06/
      data i1( 36)/ 5/,i2( 36)/ 0/,i3( 36)/ 1/,i4( 36)/ 2/
      data cf( 37)/0.8796362710782101D+08/
      data i1( 37)/ 0/,i2( 37)/ 5/,i3( 37)/ 1/,i4( 37)/ 2/
      data cf( 38)/0.2075692761172520D+08/
      data i1( 38)/ 3/,i2( 38)/ 2/,i3( 38)/ 2/,i4( 38)/ 2/
      data cf( 39)/-.2484121123843793D+08/
      data i1( 39)/ 2/,i2( 39)/ 3/,i3( 39)/ 2/,i4( 39)/ 1/
      data cf( 40)/0.6291118395227996D+08/
      data i1( 40)/ 3/,i2( 40)/ 3/,i3( 40)/ 1/,i4( 40)/ 2/
      data cf( 41)/-.1982737236772864D+07/
      data i1( 41)/ 3/,i2( 41)/ 1/,i3( 41)/ 3/,i4( 41)/ 1/
      data cf( 42)/0.2368392881235637D+08/
      data i1( 42)/ 4/,i2( 42)/ 2/,i3( 42)/ 1/,i4( 42)/ 2/
      data cf( 43)/0.6521785273882897D+07/
      data i1( 43)/ 4/,i2( 43)/ 1/,i3( 43)/ 2/,i4( 43)/ 2/
      data cf( 44)/-.2032051573037136D+09/
      data i1( 44)/ 1/,i2( 44)/ 4/,i3( 44)/ 2/,i4( 44)/ 2/
      data cf( 45)/-.3624261719379573D+08/
      data i1( 45)/ 4/,i2( 45)/ 3/,i3( 45)/ 0/,i4( 45)/ 2/
      data cf( 46)/0.7545358589031368D+05/
      data i1( 46)/ 4/,i2( 46)/ 0/,i3( 46)/ 3/,i4( 46)/ 2/
      data cf( 47)/0.6366352480056804D+08/
      data i1( 47)/ 0/,i2( 47)/ 4/,i3( 47)/ 3/,i4( 47)/ 2/
      data cf( 48)/0.3391635083048218D+06/
      data i1( 48)/ 5/,i2( 48)/ 1/,i3( 48)/ 1/,i4( 48)/ 2/
      data cf( 49)/-.6140805472163694D+09/
      data i1( 49)/ 1/,i2( 49)/ 5/,i3( 49)/ 1/,i4( 49)/ 1/
      data cf( 50)/-.2935460772867852D+07/
      data i1( 50)/ 5/,i2( 50)/ 2/,i3( 50)/ 0/,i4( 50)/ 2/
      data cf( 51)/0.2589577786022576D+05/
      data i1( 51)/ 5/,i2( 51)/ 0/,i3( 51)/ 2/,i4( 51)/ 2/
      data cf( 52)/0.1699497478590422D+09/
      data i1( 52)/ 0/,i2( 52)/ 5/,i3( 52)/ 2/,i4( 52)/ 2/
      data cf( 53)/0.4098783472067632D+06/
      data i1( 53)/ 6/,i2( 53)/ 1/,i3( 53)/ 0/,i4( 53)/ 2/
      data cf( 54)/0.1175126837599131D+05/
      data i1( 54)/ 6/,i2( 54)/ 0/,i3( 54)/ 1/,i4( 54)/ 2/
      data cf( 55)/-.1320618684760208D+09/
      data i1( 55)/ 0/,i2( 55)/ 6/,i3( 55)/ 1/,i4( 55)/ 2/
      data cf( 56)/-.2206452908739023D+08/
      data i1( 56)/ 3/,i2( 56)/ 3/,i3( 56)/ 2/,i4( 56)/ 2/
      data cf( 57)/0.1329868420726945D+08/
      data i1( 57)/ 3/,i2( 57)/ 2/,i3( 57)/ 3/,i4( 57)/ 1/
      data cf( 58)/-.2619882852334027D+08/
      data i1( 58)/ 4/,i2( 58)/ 2/,i3( 58)/ 2/,i4( 58)/ 2/
      data cf( 59)/0.1156109748678276D+09/
      data i1( 59)/ 2/,i2( 59)/ 4/,i3( 59)/ 2/,i4( 59)/ 1/
      data cf( 60)/-.4362690279952118D+08/
      data i1( 60)/ 4/,i2( 60)/ 3/,i3( 60)/ 1/,i4( 60)/ 2/
      data cf( 61)/-.1187111443130401D+07/
      data i1( 61)/ 4/,i2( 61)/ 1/,i3( 61)/ 3/,i4( 61)/ 2/
      data cf( 62)/-.4293511906352365D+08/
      data i1( 62)/ 1/,i2( 62)/ 4/,i3( 62)/ 3/,i4( 62)/ 2/
      data cf( 63)/0.4738009836694583D+08/
      data i1( 63)/ 4/,i2( 63)/ 4/,i3( 63)/ 0/,i4( 63)/ 2/
      data cf( 64)/0.6123564324229216D+07/
      data i1( 64)/ 4/,i2( 64)/ 0/,i3( 64)/ 4/,i4( 64)/ 1/
      data cf( 65)/0.3641958131988916D+07/
      data i1( 65)/ 5/,i2( 65)/ 2/,i3( 65)/ 1/,i4( 65)/ 2/
      data cf( 66)/0.1148776008255994D+07/
      data i1( 66)/ 5/,i2( 66)/ 1/,i3( 66)/ 2/,i4( 66)/ 2/
      data cf( 67)/0.3405363362678848D+09/
      data i1( 67)/ 1/,i2( 67)/ 5/,i3( 67)/ 2/,i4( 67)/ 2/
      data cf( 68)/0.1427485250694915D+08/
      data i1( 68)/ 5/,i2( 68)/ 3/,i3( 68)/ 0/,i4( 68)/ 2/
      data cf( 69)/-.4828419369392862D+07/
      data i1( 69)/ 5/,i2( 69)/ 0/,i3( 69)/ 3/,i4( 69)/ 2/
      data cf( 70)/-.1809067470353359D+09/
      data i1( 70)/ 0/,i2( 70)/ 5/,i3( 70)/ 3/,i4( 70)/ 2/
      data cf( 71)/-.1062289667963937D+07/
      data i1( 71)/ 6/,i2( 71)/ 1/,i3( 71)/ 1/,i4( 71)/ 2/
      data cf( 72)/0.5127322037997573D+09/
      data i1( 72)/ 1/,i2( 72)/ 6/,i3( 72)/ 1/,i4( 72)/ 1/
      data cf( 73)/-.2868355194739282D+07/
      data i1( 73)/ 6/,i2( 73)/ 2/,i3( 73)/ 0/,i4( 73)/ 2/
      data cf( 74)/0.2235533783466985D+07/
      data i1( 74)/ 6/,i2( 74)/ 0/,i3( 74)/ 2/,i4( 74)/ 2/
      data cf( 75)/-.1611841452773779D+09/
      data i1( 75)/ 0/,i2( 75)/ 6/,i3( 75)/ 2/,i4( 75)/ 2/
      data cf( 76)/0.2967879687628995D+06/
      data i1( 76)/ 7/,i2( 76)/ 1/,i3( 76)/ 0/,i4( 76)/ 2/
      data cf( 77)/-.4685533739224435D+06/
      data i1( 77)/ 7/,i2( 77)/ 0/,i3( 77)/ 1/,i4( 77)/ 2/
      data cf( 78)/0.1454756081120070D+09/
      data i1( 78)/ 0/,i2( 78)/ 7/,i3( 78)/ 1/,i4( 78)/ 2/
      data cf( 79)/-.3328891008759283D+08/
      data i1( 79)/ 3/,i2( 79)/ 3/,i3( 79)/ 3/,i4( 79)/ 1/
      data cf( 80)/0.4515228792188656D+08/
      data i1( 80)/ 4/,i2( 80)/ 3/,i3( 80)/ 2/,i4( 80)/ 2/
      data cf( 81)/0.2659209004381008D+07/
      data i1( 81)/ 4/,i2( 81)/ 2/,i3( 81)/ 3/,i4( 81)/ 2/
      data cf( 82)/-.2004344223435213D+07/
      data i1( 82)/ 2/,i2( 82)/ 4/,i3( 82)/ 3/,i4( 82)/ 2/
      data cf( 83)/0.4241683042569928D+08/
      data i1( 83)/ 4/,i2( 83)/ 4/,i3( 83)/ 1/,i4( 83)/ 2/
      data cf( 84)/-.1522767867103235D+08/
      data i1( 84)/ 4/,i2( 84)/ 1/,i3( 84)/ 4/,i4( 84)/ 1/
      data cf( 85)/-.1490742475241933D+07/
      data i1( 85)/ 5/,i2( 85)/ 2/,i3( 85)/ 2/,i4( 85)/ 2/
      data cf( 86)/-.1358403790981978D+09/
      data i1( 86)/ 2/,i2( 86)/ 5/,i3( 86)/ 2/,i4( 86)/ 1/
      data cf( 87)/-.9412917945061786D+07/
      data i1( 87)/ 5/,i2( 87)/ 3/,i3( 87)/ 1/,i4( 87)/ 2/
      data cf( 88)/0.1237630402402307D+08/
      data i1( 88)/ 5/,i2( 88)/ 1/,i3( 88)/ 3/,i4( 88)/ 2/
      data cf( 89)/-.6815943379044284D+07/
      data i1( 89)/ 1/,i2( 89)/ 5/,i3( 89)/ 3/,i4( 89)/ 2/
      data cf( 90)/-.2516357352703366D+08/
      data i1( 90)/ 5/,i2( 90)/ 4/,i3( 90)/ 0/,i4( 90)/ 2/
      data cf( 91)/-.1185123276960731D+07/
      data i1( 91)/ 5/,i2( 91)/ 0/,i3( 91)/ 4/,i4( 91)/ 2/
      data cf( 92)/-.1278872606072127D+08/
      data i1( 92)/ 0/,i2( 92)/ 5/,i3( 92)/ 4/,i4( 92)/ 2/
      data cf( 93)/0.8142736949097361D+06/
      data i1( 93)/ 6/,i2( 93)/ 2/,i3( 93)/ 1/,i4( 93)/ 2/
      data cf( 94)/-.6619999145622281D+07/
      data i1( 94)/ 6/,i2( 94)/ 1/,i3( 94)/ 2/,i4( 94)/ 2/
      data cf( 95)/-.2587105773201326D+09/
      data i1( 95)/ 1/,i2( 95)/ 6/,i3( 95)/ 2/,i4( 95)/ 2/
      data cf( 96)/0.4797565783272435D+07/
      data i1( 96)/ 6/,i2( 96)/ 3/,i3( 96)/ 0/,i4( 96)/ 2/
      data cf( 97)/0.2296034974639285D+07/
      data i1( 97)/ 6/,i2( 97)/ 0/,i3( 97)/ 3/,i4( 97)/ 2/
      data cf( 98)/0.1916309735830013D+09/
      data i1( 98)/ 0/,i2( 98)/ 6/,i3( 98)/ 3/,i4( 98)/ 2/
      data cf( 99)/0.2175224194158555D+07/
      data i1( 99)/ 7/,i2( 99)/ 1/,i3( 99)/ 1/,i4( 99)/ 2/
      data cf(100)/-.1611470363409738D+09/
      data i1(100)/ 1/,i2(100)/ 7/,i3(100)/ 1/,i4(100)/ 1/
      data cf(101)/0.2452899629860171D+05/
      data i1(101)/ 7/,i2(101)/ 2/,i3(101)/ 0/,i4(101)/ 2/
      data cf(102)/-.1461125261730531D+07/
      data i1(102)/ 7/,i2(102)/ 0/,i3(102)/ 2/,i4(102)/ 2/
      data cf(103)/0.3812256389790320D+08/
      data i1(103)/ 0/,i2(103)/ 7/,i3(103)/ 2/,i4(103)/ 2/
      data cf(104)/-.3476356737553229D+06/
      data i1(104)/ 8/,i2(104)/ 1/,i3(104)/ 0/,i4(104)/ 2/
      data cf(105)/0.3533606927869352D+06/
      data i1(105)/ 8/,i2(105)/ 0/,i3(105)/ 1/,i4(105)/ 2/
      data cf(106)/-.1004053833129615D+09/
      data i1(106)/ 0/,i2(106)/ 8/,i3(106)/ 1/,i4(106)/ 2/
      data cf(107)/-.7914905238055578D+06/
      data i1(107)/ 4/,i2(107)/ 3/,i3(107)/ 3/,i4(107)/ 2/
      data cf(108)/0.2499702618624246D+08/
      data i1(108)/ 3/,i2(108)/ 4/,i3(108)/ 3/,i4(108)/ 1/
      data cf(109)/-.2580156975947897D+08/
      data i1(109)/ 4/,i2(109)/ 4/,i3(109)/ 2/,i4(109)/ 2/
      data cf(110)/0.5947226242358022D+07/
      data i1(110)/ 4/,i2(110)/ 2/,i3(110)/ 4/,i4(110)/ 1/
      data cf(111)/-.1986876112301588D+07/
      data i1(111)/ 5/,i2(111)/ 3/,i3(111)/ 2/,i4(111)/ 2/
      data cf(112)/-.5485450142418097D+07/
      data i1(112)/ 5/,i2(112)/ 2/,i3(112)/ 3/,i4(112)/ 2/
      data cf(113)/0.1035929955383384D+08/
      data i1(113)/ 2/,i2(113)/ 5/,i3(113)/ 3/,i4(113)/ 2/
      data cf(114)/0.4230807660067151D+07/
      data i1(114)/ 5/,i2(114)/ 4/,i3(114)/ 1/,i4(114)/ 2/
      data cf(115)/0.1884103796980139D+07/
      data i1(115)/ 5/,i2(115)/ 1/,i3(115)/ 4/,i4(115)/ 2/
      data cf(116)/-.1491378819316536D+08/
      data i1(116)/ 1/,i2(116)/ 5/,i3(116)/ 4/,i4(116)/ 2/
      data cf(117)/0.1416498993185665D+08/
      data i1(117)/ 5/,i2(117)/ 5/,i3(117)/ 0/,i4(117)/ 2/
      data cf(118)/0.2234317214231638D+06/
      data i1(118)/ 5/,i2(118)/ 0/,i3(118)/ 5/,i4(118)/ 1/
      data cf(119)/0.4049080247678282D+07/
      data i1(119)/ 6/,i2(119)/ 2/,i3(119)/ 2/,i4(119)/ 2/
      data cf(120)/0.5068176379640893D+08/
      data i1(120)/ 2/,i2(120)/ 6/,i3(120)/ 2/,i4(120)/ 1/
      data cf(121)/0.2054586462085512D+07/
      data i1(121)/ 6/,i2(121)/ 3/,i3(121)/ 1/,i4(121)/ 2/
      data cf(122)/-.3647538267632918D+07/
      data i1(122)/ 6/,i2(122)/ 1/,i3(122)/ 3/,i4(122)/ 2/
      data cf(123)/0.1542500770520258D+08/
      data i1(123)/ 1/,i2(123)/ 6/,i3(123)/ 3/,i4(123)/ 2/
      data cf(124)/-.1508338335569201D+07/
      data i1(124)/ 6/,i2(124)/ 4/,i3(124)/ 0/,i4(124)/ 2/
      data cf(125)/-.3466203267568607D+05/
      data i1(125)/ 6/,i2(125)/ 0/,i3(125)/ 4/,i4(125)/ 2/
      data cf(126)/-.1230250821770046D+08/
      data i1(126)/ 0/,i2(126)/ 6/,i3(126)/ 4/,i4(126)/ 2/
      data cf(127)/-.1953022329518582D+07/
      data i1(127)/ 7/,i2(127)/ 2/,i3(127)/ 1/,i4(127)/ 2/
      data cf(128)/0.2413614188927394D+07/
      data i1(128)/ 7/,i2(128)/ 1/,i3(128)/ 2/,i4(128)/ 2/
      data cf(129)/0.7286600636560850D+08/
      data i1(129)/ 1/,i2(129)/ 7/,i3(129)/ 2/,i4(129)/ 2/
      data cf(130)/-.9899524326647331D+06/
      data i1(130)/ 7/,i2(130)/ 3/,i3(130)/ 0/,i4(130)/ 2/
      data cf(131)/-.2302127508044921D+06/
      data i1(131)/ 7/,i2(131)/ 0/,i3(131)/ 3/,i4(131)/ 2/
      data cf(132)/-.6853689683776022D+08/
      data i1(132)/ 0/,i2(132)/ 7/,i3(132)/ 3/,i4(132)/ 2/
      data cf(133)/-.7180922094974692D+06/
      data i1(133)/ 8/,i2(133)/ 1/,i3(133)/ 1/,i4(133)/ 2/
      data cf(134)/-.1028403904093006D+08/
      data i1(134)/ 1/,i2(134)/ 8/,i3(134)/ 1/,i4(134)/ 1/
      data cf(135)/0.4747997436598557D+06/
      data i1(135)/ 8/,i2(135)/ 2/,i3(135)/ 0/,i4(135)/ 2/
      data cf(136)/0.2116103763886253D+06/
      data i1(136)/ 8/,i2(136)/ 0/,i3(136)/ 2/,i4(136)/ 2/
      data cf(137)/0.1853526448103250D+08/
      data i1(137)/ 0/,i2(137)/ 8/,i3(137)/ 2/,i4(137)/ 2/
      data cf(138)/0.6151401416503911D+05/
      data i1(138)/ 9/,i2(138)/ 1/,i3(138)/ 0/,i4(138)/ 2/
      data cf(139)/-.5839485717868322D+05/
      data i1(139)/ 9/,i2(139)/ 0/,i3(139)/ 1/,i4(139)/ 2/
      data cf(140)/0.3106752896954788D+08/
      data i1(140)/ 0/,i2(140)/ 9/,i3(140)/ 1/,i4(140)/ 2/
      vex1=0.4864804287159907D+00
      vex2=0.8446879161719891D+00
      f12(0)=1.d0
      f13(0)=1.d0
      f23(0)=1.d0
      bux12=r12*dexp(-vex1*r12)
      bux13=r13*dexp(-vex1*r13)
      bux23=r23*dexp(-vex2*r23)
      do 1 i=1, 9
         f12(i)=f12(i-1)*bux12
         f13(i)=f13(i-1)*bux13
         f23(i)=f23(i-1)*bux23
1     continue
      ener = -341.441479109168
      der12 = 0.d0
      der13 = 0.d0
      der23 = 0.d0
      do 2 l=1,140
         if (i4(l).eq.1) then                             
            aux=f12(i1(l))*f13(i3(l))*f23(i2(l))          
            dux12=i1(l)*f12(i1(l)-1)*f13(i3(l))*f23(i2(l))
            dux13=i3(l)*f12(i1(l))*f13(i3(l)-1)*f23(i2(l))
            dux23=i2(l)*f12(i1(l))*f13(i3(l))*f23(i2(l)-1)
         else                                             
            aux1=f12(i1(l))*f13(i3(l))                    
            aux2=f12(i3(l))*f13(i1(l))                    
            aux=(aux1+aux2)*f23(i2(l))                    
            dux23=(aux1+aux2)*i2(l)*f23(i2(l)-1)          
            dux1=i1(l)*f12(i1(l)-1)*f13(i3(l))            
            dux2=i3(l)*f12(i3(l)-1)*f13(i1(l))            
            dux12=(dux1+dux2)*f23(i2(l))                  
            dux1=i3(l)*f12(i1(l))*f13(i3(l)-1)            
            dux2=i1(l)*f12(i3(l))*f13(i1(l)-1)            
            dux13=(dux1+dux2)*f23(i2(l))                  
         endif                                            
         ener=ener+cf(l)*aux                              
         der12=der12+cf(l)*dux12                          
         der13=der13+cf(l)*dux13                          
         der23=der23+cf(l)*dux23                          
    2 continue                                          
      der(1)=der12*(1.d0-vex1*r12)*dexp(-vex1*r12)        
      der(2)=der13*(1.d0-vex1*r13)*dexp(-vex1*r13)        
      der(3)=der23*(1.d0-vex2*r23)*dexp(-vex2*r23)        
      return
      end
